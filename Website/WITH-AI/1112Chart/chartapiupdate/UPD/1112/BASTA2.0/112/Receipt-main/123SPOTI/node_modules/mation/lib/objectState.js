'use strict';

exports.__esModule = true;

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

var _state = require('./state');

var _state2 = _interopRequireDefault(_state);

var _spring = require('./spring');

function mapObj(obj, transform) {
  var ret = {};
  var keys = Object.keys(obj);
  for (var i = 0; i < keys.length; i++) {
    ret[keys[i]] = transform(obj[keys[i]]);
  }
  return ret;
}

var ObjectState = (function () {
  function ObjectState(val) {
    _classCallCheck(this, ObjectState);

    this.moving = false;

    this.x = mapObj(val, function (v) {
      return v;
    });
    this.states = mapObj(val, function (v) {
      return _state2['default'](v);
    });
  }

  ObjectState.prototype.step = function step(delta, destination, config) {
    if (_spring.isSpring(destination)) return this.step(delta, destination.value, destination.config);

    this.moving = false;
    var keys = Object.keys(this.states);
    for (var i = 0; i < keys.length; i++) {
      var key = keys[i];
      var state = this.states[key];
      state.step(delta, destination[key], config);
      this.x[key] = state.x;
      if (state.moving) this.moving = true;
    }
    return this;
  };

  return ObjectState;
})();

exports['default'] = ObjectState;
module.exports = exports['default'];